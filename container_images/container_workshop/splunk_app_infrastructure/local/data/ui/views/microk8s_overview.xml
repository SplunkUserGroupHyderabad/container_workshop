<form refresh="60" theme="dark">
  <label>Microk8s Overview</label>
  <fieldset submitButton="false" autoRun="false">
    <input type="time" token="timepicker">
      <label></label>
      <default>
        <earliest>-4h@m</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="dropdown" token="cluster_name" searchWhenChanged="true">
      <label>Cluster</label>
      <choice value="*">ALL</choice>
      <fieldForLabel>cluster_name</fieldForLabel>
      <fieldForValue>cluster_name</fieldForValue>
      <search>
        <query>index=em_meta sourcetype::kube:objects:nodes
| stats count by cluster_name</query>
        <earliest>-60m@m</earliest>
        <latest>now</latest>
      </search>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="dropdown" token="namespace" searchWhenChanged="true">
      <label>Namespace</label>
      <fieldForLabel>metadata.name</fieldForLabel>
      <fieldForValue>metadata.name</fieldForValue>
      <search>
        <query>index=em_meta sourcetype::kube:objects:namespaces
| stats count by metadata.name</query>
        <earliest>-8h@h</earliest>
        <latest>now</latest>
      </search>
      <choice value="*">ALL</choice>
      <initialValue>*</initialValue>
      <default>*</default>
    </input>
  </fieldset>
  <row>
    <panel>
      <single>
        <search>
          <query>index=em_meta sourcetype::kube:objects:services metadata.namespace=$namespace$
| timechart partial=f span=60s count(metadata.name) AS services</query>
          <earliest>-4h@m</earliest>
          <latest>now</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="height">115</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x53a051"]</option>
        <option name="rangeValues">[0]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="trendInterval">-4h</option>
        <option name="underLabel">Services</option>
        <option name="unitPosition">after</option>
        <option name="useColors">0</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <search>
          <query>index=em_meta sourcetype::kube:objects:deployments metadata.namespace=$namespace$
| timechart partial=f span=60s count(metadata.name) as deployments</query>
          <earliest>-4h@m</earliest>
          <latest>now</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="height">115</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x53a051"]</option>
        <option name="rangeValues">[0]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="trendInterval">-4h</option>
        <option name="underLabel">deployments</option>
        <option name="unitPosition">after</option>
        <option name="useColors">0</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <search>
          <query>index=em_meta sourcetype::kube:objects:replica_sets metadata.namespace=$namespace$
| timechart partial=f span=60s count(metadata.name) AS replicasets</query>
          <earliest>-4h@m</earliest>
          <latest>now</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="height">115</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x555","0x555"]</option>
        <option name="rangeValues">[0]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="trendInterval">-4h</option>
        <option name="underLabel">Replica Sets</option>
        <option name="unitPosition">after</option>
        <option name="useColors">0</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <search>
          <query>index=em_meta sourcetype::kube:objects:pods metadata.namespace=$namespace$
| timechart partial=f span=60s count(metadata.name) AS pods</query>
          <earliest>-4h@m</earliest>
          <latest>now</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="height">115</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x555","0x555"]</option>
        <option name="rangeValues">[0]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="trendInterval">-4h</option>
        <option name="underLabel">pods</option>
        <option name="unitPosition">before</option>
        <option name="useColors">0</option>
        <option name="useThousandSeparators">0</option>
      </single>
    </panel>
    <panel>
      <single>
        <search>
          <query>index=em_meta sourcetype::kube:objects:daemon_sets metadata.namespace=$namespace$
| timechart span=60s partial=f count(metadata.name) AS daemonsets</query>
          <earliest>-4h@m</earliest>
          <latest>now</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="height">115</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x555","0x555"]</option>
        <option name="rangeValues">[0]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">0</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="trendInterval">-4h</option>
        <option name="underLabel">Daemon Sets</option>
        <option name="unitPosition">after</option>
        <option name="useColors">0</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <input type="link" token="needed">
        <label>Cluster Log Trend:</label>
        <choice value="link1">Overall Trend</choice>
        <choice value="link2">Logs By Pod</choice>
        <choice value="link3">Errors By Pod</choice>
        <default>link1</default>
        <change>
          <condition value="link1">
            <set token="showAll">true</set>
            <unset token="showPod"></unset>
            <unset token="errorPod"></unset>
          </condition>
          <condition value="link2">
            <unset token="showAll"></unset>
            <set token="showPod">true</set>
            <unset token="errorPod"></unset>
          </condition>
          <condition value="link3">
            <unset token="showAll"></unset>
            <unset token="showPod"></unset>
            <set token="errorPod">true</set>
          </condition>
        </change>
      </input>
      <chart depends="$showAll$">
        <search type="annotation">
          <query>index=_internal sourcetype=splunkd "loader - Splunkd starting" AND punct="--_::._+____-___(_)." 
| eval annotation_label = message
| eval annotation_category = log_level</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <search>
          <query>| tstats prestats=t count WHERE index=em_events sourcetype=kube:container:* namespace=$namespace$ by namespace, _time span=60s
| timechart partial=f span=60s count by namespace</query>
          <earliest>$timepicker.earliest$</earliest>
          <latest>$timepicker.latest$</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <!-- Secondary search that drives the annotations -->
        <!-- Customize the event annotation colors based on category name -->
        <option name="charting.annotation.categoryColors">{"ERROR":"0xff3300","WARN":"0xffcc00"}</option>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">collapsed</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.abbreviation">none</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.abbreviation">none</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.abbreviation">none</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">area</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.overlayFields">stderr</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.mode">standard</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.lineWidth">2</option>
        <option name="charting.seriesColors">[0x146eb4,0xff9900,0x979A9A,0x3F6FDE,0x99B2CC,0x7094B8,0x4775A3,0x2E5C8A,0x24476B,0x1A334C,0x0F1F2E,0x050A0F,0x5D6D7E,0x5DADE2,0xF7DC6F,0xF0B27A,0x6C3483,0x1B4F72]</option>
        <option name="height">287</option>
        <option name="refresh.display">progressbar</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <drilldown>
          <link target="_blank">search?q=index=em_events sourcetype::kube:container:* namespace::$namespace$&amp;earliest=$timepicker.earliest$&amp;latest=$timepicker.latest$</link>
        </drilldown>
      </chart>
      <chart depends="$showPod$">
        <search>
          <query>| tstats prestats=t count WHERE index=em_events sourcetype::kube:container:* AND namespace=$namespace$ by pod _time span=1m
| timechart partial=f span=1m count by pod limit=0</query>
          <earliest>$timepicker.earliest$</earliest>
          <latest>$timepicker.latest$</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.abbreviation">none</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.abbreviation">none</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.abbreviation">none</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">area</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.mode">standard</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.lineWidth">2</option>
        <option name="charting.seriesColors">[0x146eb4,0xff9900,0x979A9A,0x3F6FDE,0x99B2CC,0x7094B8,0x4775A3,0x2E5C8A,0x24476B,0x1A334C,0x0F1F2E,0x050A0F,0x5D6D7E,0x5DADE2,0xF7DC6F,0xF0B27A,0x6C3483,0x1B4F72]</option>
        <option name="refresh.display">progressbar</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">0</option>
        <option name="trellis.size">small</option>
        <option name="trellis.splitBy">host</option>
        <drilldown>
          <link target="_blank">search?q=index=em_events sourcetype::kube:container:* namespace::$namespace$&amp;earliest=$timepicker.earliest$&amp;latest=$timepicker.latest$</link>
        </drilldown>
      </chart>
      <chart depends="$errorPod$">
        <search>
          <query>index=em_events sourcetype::kube:container:* ERROR OR WARN namespace::$namespace$
| timechart partial=f count by pod limit=0</query>
          <earliest>$timepicker.earliest$</earliest>
          <latest>$timepicker.latest$</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">collapsed</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.abbreviation">none</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.abbreviation">none</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.abbreviation">none</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.mode">standard</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.lineWidth">2</option>
        <option name="charting.seriesColors">[0x146eb4,0xff9900,0x979A9A,0x3F6FDE,0x99B2CC,0x7094B8,0x4775A3,0x2E5C8A,0x24476B,0x1A334C,0x0F1F2E,0x050A0F,0x5D6D7E,0x5DADE2,0xF7DC6F,0xF0B27A,0x6C3483,0x1B4F72]</option>
        <option name="refresh.display">progressbar</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">0</option>
        <option name="trellis.size">small</option>
        <option name="trellis.splitBy">host</option>
        <drilldown>
          <link target="_blank">search?q=index=em_events  sourcetype::kube:container:* ERROR OR WARN namespace=$namespace$
| timechart partial=f count by pod limit=0&amp;earliest=$timepicker.earliest$&amp;latest=$timepicker.latest$</link>
        </drilldown>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <single>
        <search>
          <query>index=em_meta sourcetype=kube:objects:nodes "metadata.name"=*
| bin span=60s _time
| stats dc("metadata.name") AS nodes</query>
          <earliest>-60s</earliest>
          <latest>now</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="height">115</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x555","0x555"]</option>
        <option name="rangeValues">[0]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="trendInterval">-4h</option>
        <option name="underLabel">nodes</option>
        <option name="unitPosition">after</option>
        <option name="useColors">0</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <search>
          <query>index=em_meta sourcetype::kube:objects:nodes
| timechart span=60s partial=f sum(status.allocatable.cpu) AS allocatable.cpu</query>
          <earliest>-4h@m</earliest>
          <latest>now</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="height">115</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x555","0x555"]</option>
        <option name="rangeValues">[0]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="trendInterval">-4h</option>
        <option name="underLabel">Total Allocatable CPU</option>
        <option name="unitPosition">after</option>
        <option name="useColors">0</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <search>
          <query>index=em_meta sourcetype::kube:objects:pods metadata.namespace=$namespace$
| stats list(spec.containers{}.resources.requests.cpu) AS resources.requests.cpu by _time metadata.name, spec.nodeName
| eval resources.requests.cpu=if(isnull('resources.requests.cpu'),0,'resources.requests.cpu')
| mvexpand resources.requests.cpu
| rex field=resources.requests.cpu "(?&lt;resources_requests_cpu_unit&gt;\D+)"
| convert rmunit(resources.*)
| eval cpu_request_divide = case(resources_requests_cpu_unit="m", 1000)
| eval cpu_requests_converted = if(isnum(cpu_request_divide), 'resources.requests.cpu' / 'cpu_request_divide', 'resources.requests.cpu')
| timechart partial=f span=60s sum(cpu_requests_converted) AS resources.requests.cpu</query>
          <earliest>-4h@m</earliest>
          <latest>now</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="height">115</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x555","0x555"]</option>
        <option name="rangeValues">[0]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="trendInterval">-4h</option>
        <option name="underLabel">Total CPU Requests  - m</option>
        <option name="unitPosition">after</option>
        <option name="useColors">0</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <search>
          <query>index=em_meta sourcetype::kube:objects:pods metadata.namespace=$namespace$
| stats list(spec.containers{}.resources.limits.cpu) AS resources.limits.cpu by _time, metadata.name, spec.nodeName
| eval resources.limits.cpu=if(isnull('resources.limits.cpu'), 0, 'resources.limits.cpu')
| mvexpand resources.limits.cpu
| rex field=resources.limits.cpu "(?&lt;resources_limits_cpu_unit&gt;\D+)"
| convert rmunit(resources.*)
| eval cpu_limits_divide = case(resources_limits_cpu_unit="m", 1000)
| eval cpu_limits_converted = if(isnum(cpu_limits_divide), 'resources.limits.cpu' / 'cpu_limits_divide', 'resources.limits.cpu')
| timechart span=60s partial=f sum(cpu_limits_converted) AS resources.limits.cpu</query>
          <earliest>-4h@m</earliest>
          <latest>now</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="height">115</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x555","0x555"]</option>
        <option name="rangeValues">[0]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="trendInterval">-4h</option>
        <option name="underLabel">Total CPU Limits - m</option>
        <option name="unitPosition">after</option>
        <option name="useColors">0</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <title>Nodes</title>
      <table>
        <search>
          <query>index=em_meta sourcetype::kube:objects:nodes
| stats values(status.nodeInfo.osImage) AS osImage, values(status.nodeInfo.kubeletVersion) AS kubeletVersion, values(status.nodeInfo.containerRuntimeVersion) AS containerRuntimeVersion, values(metadata.creationTimestamp) AS creationTimestamp, values(metadata.labels.beta.kubernetes.io/os) AS os, values(status.conditions{}.message) AS message, max(_time) AS "lastPoll" by metadata.name
| eval lastPoll=strftime(lastPoll, "%Y-%m-%d %H:%M:%S")
| rename metadata.name AS name
| appendcols
    [search index=em_meta earliest=-60s@s latest=now sourcetype=kube:objects:pods "status.containerStatuses{}.ready"=true
| bin span=60s _time 
| stats count AS pods by spec.nodeName, _time]
| appendcols
    [search earliest=-60s@s latest=now index=em_meta sourcetype::kube:objects:nodes
| stats values(status.allocatable.pods) AS allocatablePods by metadata.name]
| fields - metadata.name spec.nodeName
| table name osImage kubeletVersion containerRuntimeVersion creationTimestamp os pods allocatablePods message lastPoll</query>
          <earliest>-4h@m</earliest>
          <latest>now</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>kube.cluster.cpu.usage by cluster_name</title>
        <search>
          <query>| mstats avg(_value) prestats=true WHERE metric_name="kube.cluster.cpu.usage" AND "index"="em_metrics" span=1s BY "cluster_name" 
| timechart avg(_value) as "Latest" limit=5 useother=false span=1m BY "cluster_name"</query>
          <earliest>$timepicker.earliest$</earliest>
          <latest>$timepicker.latest$</latest>
        </search>
        <option name="charting.axisY.abbreviation">auto</option>
        <option name="charting.axisY.includeZero">1</option>
        <option name="charting.chart">area</option>
        <option name="charting.chart.nullValueMode">zero</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.fieldColors">undefined</option>
        <option name="charting.gridLinesX.showMajorLines">1</option>
        <option name="charting.legend.mode">standard</option>
        <option name="charting.legend.placement">bottom</option>
        <option name="displayview">analysis_workspace</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>kube.namespace.cpu.usage by name</title>
        <search>
          <query>| mstats avg(_value) prestats=true WHERE metric_name="kube.namespace.cpu.usage" AND "index"="em_metrics" span=2m BY "name" 
| timechart avg(_value) as "Avg" agg=max limit=5 useother=false span=2m BY "name"</query>
          <earliest>$timepicker.earliest$</earliest>
          <latest>$timepicker.latest$</latest>
          <refresh>1m</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="charting.axisY.abbreviation">auto</option>
        <option name="charting.axisY.includeZero">1</option>
        <option name="charting.chart">area</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.fieldColors">undefined</option>
        <option name="charting.gridLinesX.showMajorLines">1</option>
        <option name="charting.legend.mode">standard</option>
        <option name="charting.legend.placement">bottom</option>
        <option name="displayview">analysis_workspace</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>kube.pod.cpu.usage_rate by pod-name</title>
        <search>
          <query>| mstats avg(_value) prestats=true WHERE metric_name="kube.pod.cpu.usage_rate" AND "index"="em_metrics" span=2m BY "pod-name" 
| timechart avg(_value) as "Avg" agg=max limit=20 useother=false span=2m BY "pod-name"</query>
          <earliest>$timepicker.earliest$</earliest>
          <latest>$timepicker.latest$</latest>
          <refresh>1m</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="charting.axisY.abbreviation">auto</option>
        <option name="charting.axisY.includeZero">1</option>
        <option name="charting.chart">area</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.fieldColors">undefined</option>
        <option name="charting.gridLinesX.showMajorLines">1</option>
        <option name="charting.legend.mode">standard</option>
        <option name="charting.legend.placement">bottom</option>
        <option name="displayview">analysis_workspace</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>kube.pod.memory.usage_bytes by pod-name</title>
        <search>
          <query>| mstats avg(_value) prestats=true WHERE metric_name="kube.pod.memory.usage_bytes" AND "index"="em_metrics" span=2m BY "pod-name" 
| timechart avg(_value) as "Avg" agg=max limit=20 useother=false span=2m partial=f BY "pod-name"</query>
          <earliest>$timepicker.earliest$</earliest>
          <latest>$timepicker.latest$</latest>
          <refresh>1m</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="charting.axisY.abbreviation">auto</option>
        <option name="charting.axisY.includeZero">1</option>
        <option name="charting.chart">area</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.fieldColors">undefined</option>
        <option name="charting.gridLinesX.showMajorLines">1</option>
        <option name="charting.legend.mode">seriesCompare</option>
        <option name="displayview">analysis_workspace</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>kube.cluster.memory.usage by cluster_name</title>
        <search>
          <query>| mstats avg(_value) prestats=true WHERE metric_name="kube.cluster.memory.usage" AND "index"="em_metrics" span=2m BY "cluster_name" 
| timechart avg(_value) as "Avg" agg=max limit=5 useother=false span=2m BY "cluster_name"</query>
          <earliest>$timepicker.earliest$</earliest>
          <latest>$timepicker.latest$</latest>
          <refresh>1m</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="charting.axisY.abbreviation">auto</option>
        <option name="charting.axisY.includeZero">1</option>
        <option name="charting.chart">area</option>
        <option name="charting.chart.nullValueMode">zero</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.fieldColors">undefined</option>
        <option name="charting.gridLinesX.showMajorLines">1</option>
        <option name="charting.legend.mode">seriesCompare</option>
        <option name="displayview">analysis_workspace</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>kube.namespace.memory.usage by name</title>
        <search>
          <query>| mstats avg(_value) prestats=true WHERE metric_name="kube.namespace.memory.usage" AND "index"="em_metrics" span=2m BY "name" 
| timechart avg(_value) as "Avg" agg=max limit=5 useother=false span=2m BY "name"</query>
          <earliest>$timepicker.earliest$</earliest>
          <latest>$timepicker.latest$</latest>
          <refresh>1m</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="charting.axisY.abbreviation">auto</option>
        <option name="charting.axisY.includeZero">1</option>
        <option name="charting.chart">area</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.fieldColors">undefined</option>
        <option name="charting.gridLinesX.showMajorLines">1</option>
        <option name="charting.legend.mode">seriesCompare</option>
        <option name="displayview">analysis_workspace</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
</form>
